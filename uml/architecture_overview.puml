@startuml Architecture Overview

!define ICONURL https://raw.githubusercontent.com/tupadr3/plantuml-icon-font-sprites/v2.4.0

skinparam dpi 200
skinparam packageStyle rectangle
skinparam linetype ortho

package "Presentation Layer" {
  [MainWindow (Qt UI)]
}

package "Application Layer" {
  interface IApplicationService
  [ApplicationService]
  
  ApplicationService ..|> IApplicationService
}

package "Service Layer" {
  
  package "Filter Services" {
    interface IFilterService
    [ButterworthFilterService]
    [MovingAverageFilterService]
    
    ButterworthFilterService ..|> IFilterService
    MovingAverageFilterService ..|> IFilterService
  }
  
  package "Signal Detection" {
    interface IRPeaksDetectionService
    interface IWavesDetectionService
    interface IHeartClassDetectionService
    
    [RPeaksDetectionService]
    [WavesDetectionService]
    [HeartClassDetectionService]
    
    RPeaksDetectionService ..|> IRPeaksDetectionService
    WavesDetectionService ..|> IWavesDetectionService
    HeartClassDetectionService ..|> IHeartClassDetectionService
  }
  
  package "HRV Processing" {
    interface IHRVTimeProcessingService
    interface IHRVGeoProcessingService
    interface IHRVDFAProcessingService
    
    [HRVTimeProcessingService]
    [HRVGeoProcessingService]
    [HRVDFAProcessingService]
    
    HRVTimeProcessingService ..|> IHRVTimeProcessingService
    HRVGeoProcessingService ..|> IHRVGeoProcessingService
    HRVDFAProcessingService ..|> IHRVDFAProcessingService
  }
}

package "Repository Layer" {
  interface ISignalRepository
  [CSVSignalRepository]
  
  CSVSignalRepository ..|> ISignalRepository
}

package "Model Layer" {
  [SignalDatapoint]
  [SignalDataset]
  [RPeaksAnnotatedSignalDatapoint]
  [WaveAnnotatedSignalDatapoint]
}

package "DTO Layer" {
  [FilterMethod]
  [SignalRange]
  [Status]
  [HeartClassResult]
  [HRVTimeMetrics]
  [HRVGeoMetrics]
  [HRVDFAMetrics]
}

[MainWindow (Qt UI)] --> IApplicationService : uses

ApplicationService --> ISignalRepository : uses
ApplicationService --> IFilterService : uses
ApplicationService --> IRPeaksDetectionService : uses
ApplicationService --> IWavesDetectionService : uses
ApplicationService --> IHeartClassDetectionService : uses
ApplicationService --> IHRVTimeProcessingService : uses
ApplicationService --> IHRVGeoProcessingService : uses
ApplicationService --> IHRVDFAProcessingService : uses

ISignalRepository --> [Model Layer] : returns
[Service Layer] --> [DTO Layer] : uses
[Service Layer] --> [Model Layer] : uses
IApplicationService --> [DTO Layer] : uses

note right of ApplicationService
  Dependency Injection Pattern:
  All services injected via constructor
  Decouples implementation from interfaces
end note

note right of [Service Layer]
  Single Responsibility:
  Each service handles one specific
  aspect of signal processing
end note

@enduml

